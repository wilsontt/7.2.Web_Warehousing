### 文件倉儲管理系統  Warehouse Management System 設計規範
**版本 Version**：v2.1.0  
**核准日期 Ratified**：2025-11-09  
**最近修訂 Last Amended**：2025-11-09

#### 第一部分：使用者介面與體驗 (UI/UX)
1. 總體風格與響應式設計
   - 風格(用色)參考： https://femashr.com/ 的簡潔科技感，採淺色底、淡淺水藍色線條、圓角按鈕。
   - 響應式支援： 優先支援桌面螢幕與平板裝置 (iPad)。平板模式下應支援漢堡選單。
   - 深色模式： 應提供手動切換及根據作業系統偏好自動切換的功能，切換過程需有流暢的動畫效果，預設淺色模式。
2. 頁面框架 (Layout)
   - 登入頁： 驗證成功後，導向系統首頁 (Dashboard)。
   - 主框架：
     - A 區 (頂部導覽列): position: sticky; 固定於頁面頂部，不隨頁面滾動。
     - B 區 (主要內容區): 佔據 A 區下方的所有空間。
3. A 區 - 頂部導覽列 分三部份
   - 靠左側： 品牌 Logo + "文件倉儲管理系統" 文字。
   - 在中間 (主選單)：
     - 使用「直向展開下拉選單」方式進行設計。
     - 基本作業、例行作業、庫存作業、客戶作業、移儲作業、稽核作業、倉儲⼯作異動作業、系統管理作業。
     - [UX 建議] 應根據登入者的角色權限，僅顯示其可操作的主選單。
   - 靠右側：
     - 語系選擇： 正體中文 / English。
     - 使用者選單 (下拉式)：
       - 顯示已登入的「帳號名稱」。
       - 下拉內容包含：登入帳號、電腦 IP、登入時間、密碼變更、登出。
     - 深色/淺色模式切換：
       - 提供明確的主題切換控制，預設為淺色模式，支援系統偏好偵測；切換時需同步影響整個介面（主選單、子選單、主要內容區、對話框、表格、框線與文字顏色）。
4. B 區 - 主要內容區
   - 佈局： 分為 Master / B1 左側欄 (資料列表) 與 Detail / B2 右側區 (主要內容)，側欄寬度可手動拖曳調整。
   - B1 左側欄 (資料列表區):
     - 功能列： 列表頂部應包含「分頁標籤」與「每頁顯示筆數」選項。
     - 列表樣式： 隔行變色 (Zebra-striping)，被選取的資料列需高亮 (Highlight) 顯示。
       - [重點‼️] 篩選功能： 應提供篩選器或進階搜尋功能。
       - 欄位內的內容如果太長超過欄位的寬度，不要自動折行。(whitespace-nowrap)
     - 預設寬度調：25%，最小寬度 minLeftSize 為 18，最大寬度 maxLeftSize 為 30%。
     - 如果全部的欄位加起來的寬度超過預設寬度，就加上水平捲軸。(overflow-x-auto)
   - B2 右側區 (詳細內容區):
     - B2-1 (頂部工具列):
       - 左側： 以麵包屑 (Breadcrumbs) 模式顯示當前頁面的導覽路徑 (例：基本作業 > 客戶資料維護 > 客戶基本資料維護)。
       - 右側 (Toolbar): 包含 新增、修改、查詢、列印、確認、取消 及 停用/封存 按鈕。
       - [注意❗️] 按鈕應根據資料狀態動態啟用或禁用。
     - B2-2 (資料內容區):
       - 預設顯示： 預設顯示 B1 區列表的第一筆資料的詳細內容。
       - 頁面類型：
         - 標準設定頁面： 依欄位顯示資料，底部需有「狀態列」。若頁面再分上下區，則各區底部皆需有狀態列。
         - 自訂頁面： 依據特定功能需求自訂畫面佈局。
       - [重點‼️] 輸入驗證： 所有輸入欄位皆需有前端驗證規則 (如必填、格式)，並在不符規則時提供明確提示。

#### 第二部分：功能需求
> DataTable 組件標準化配置
> 用於確保整個專案中 DataTable 組件的一致性
1. 共用元件
   - 分頁 (Pagination): 參考 Tailwind UI 元件，預設每頁 20 筆，可選 5, 10, 20, 50, 100 筆。
   - 麵包屑 (Breadcrumbs): 參考 Tailwind UI 元件。
   - 狀態列，分左右2邊，一列顯示： 
     - 新增人員：[用戶名] yyyy/MM/dd hh:mm:ss ， 上次修改：[用戶名] yyyy/MM/dd hh:mm:ss
   - Toolbar按鈕：
     - 查詢 → 改為搜尋/篩選功能
     - 新增 → 清空表單進入新增模式
     - 修改 → 進入編輯模式
     - 停用 → 用於作廢之記錄（保留資料但停用資料）
     - 刪除 → 僅限未被引用的記錄
     - 複製 → 複製當前資料到新表單（建議新增）
   - 在TABLE_WRAPPER_CLASSES 中添加 overflow-auto，確保表格容器有適當的高度和捲軸。
2. 登入頁
   - 欄位： 帳號、密碼 (輸入時以 * 遮蔽，提供顯示/隱藏切換按鈕)。
   - 驗證與錯誤處理：
     - 帳號或密碼錯誤時，統一提示：「您輸入的帳號或密碼不正確，請重新輸入。」
     - 錯誤計次： 分別記錄錯誤次數。
     - 帳號鎖定： 連續錯誤達 6 次後，鎖定該帳號並提示：「您已連續輸入錯誤達 6 次，帳號已被鎖定。請與管理人員聯繫。」
   - 測試帳號： 建立三種權限的帳號：admin (管理員)、manager (主管)、user (一般使用者)。
3. 首頁 (Dashboard)
   - 上半部顯示
     • 今日任務總覽（未完成單據、待出貨數、待稽核數）
     • 倉庫即時庫存概況（總箱數、使用率、異常數）
     • 最新通知（公告、異常提醒、系統更新）
   - 下半部顯示
     - 依登入著所屬倉庫顯示自己倉庫的資訊，管理者則預設顯示全部。
     - 各倉庫箱子可存放數量 / 已存放數量 / 借出數量
     - 各倉庫今日工作狀態
     - 今日車輛派送路線及收送貨即時狀況
     - 各倉庫依客戶統計逾時未銷毀數量 (Top 10 list)
     - 依客戶統計存倉數量 (箱/件 Top 10 list)
     - 指定(客戶-部門-組別-成本中心)＋(日期範圍)＋(工作項目-工作原因) → 長條圖趨勢
4. 選單與功能結構
    下拉的子功能項目的也放在各自主要選項的資料夾內，8個下拉選項：
     - 1.基本作業 (Basic Operations)：
        - 代碼作業
           - 基本代碼維護
           - 箱、件代碼維護
        - 員工資料維護
        - 客戶資料維護
           - 客戶基本資料維護
           - 客戶群維護 
        - 倉庫、車輛維護
           - 倉庫維護
           - 車輛維護
           - 收送區域維護
        - 箱子資料維護
        - 基本收費作業
     - 2.例行作業 (Routine Operations)：
        - 客戶工作通知單
        - 倉儲工作單
        - 倉儲作業
          - 工作單派車作業
          - 工作單上下架/稽核報表
          - 工作單
            - 上下架輸入
            - 稽核輸入
          - 出倉車輛運輸單
        - 交換作業
          - 玉山資料交換作業
          - 中信資料交換作業
     - 3.庫存作業 (Inventory Operations)：
        - 箱子/物件 即時庫存查詢
        - 倉儲報表及條碼作業
           - 倉儲報表作業
                - 倉儲工作報表
                - 箱件即時庫存報表
                - 倉儲客戶月報統計表
                - 工作單箱件統計表
                - 箱件每日進出月報表
                - 物件箱物件清單
                - 出倉車輛運輸單
           - 條碼作業
                - 箱子自訂條碼列印
                - 物件自訂條碼列印
                - 儲位條碼列印
                - 封箱條碼列印
                - 新光特規條碼列印
     - 4.客戶作業 (Customer Operations)：
        - 客戶工作通知單
        - 工作通知單審核作業
        - 箱子/物件 即時庫存查詢
        - 箱子/物件 倉儲報表下載
     - 5.移儲作業 (Relocation Operations)：
        - 移出作業
          - 移出單作業
          - 移出下架作業
          - 移出稽核作業
        - 移入作業
          - 移入單作業
          - 移入下架作業
          - 移入稽核作業
     - 6.稽核作業 (Audit Operations)：
        - 表A003 存倉物品抽查記錄表
        - 表A004 倉庫表單抽查記錄表
        - A005文件進倉記錄表
        - 盤點作業
          - 盤點單作業盤點
          - 初盤作業盤點
          - 複盤作業
     - 7.倉儲⼯作異動作業：更名為 倉儲管理作業 (Warehouse Administrative Operations)
        - ⼯作單維護
          - ⼯作單主檔維護
          - ⼯作單明細維護
        - 移儲單維護
          - 移出單維護
          - 移入單維護
        - 盤點單維護
        - 各種單據主管審核
          - 通知單取消審核
          - 移出/移入單取消審核
          - 盤點單取消審核
        - 箱子/物件 庫存維護
     - 8.系統管理作業 (System Administration)：
        - 系統管理者帳號設定
        - 系統參數設定
          - 通知方式
          - 多語系維護
        - 客戶使用者設定
        - 使用者帳號角色設定
        - 系統權限控管設定
          - 群組權限設定
          - 使用者群組設定
          - 功能選單設定 
        - 資料交換作業維護
        - 郵件通知作業維護
        - 最新訊息通知
        - 系統狀態與測試
        - 系統操作紀錄
5. 資料欄位規範
   - 客戶編號： 固定 5 碼，僅允許英數字。
   - 部門編號： 最大 4 碼，僅允許英數字。
   - [注意❗️] 所有輸入欄位應設定 maxLength 屬性，防止使用者輸入超過規定長度的資料。


### 深/淺色模式一致性（2025/11/16 更新，2025/11/17 補充）
- 適用範圍：A 區 TopNavigation、主選單與子選單面板、B 區主要內容區、所有表格/卡片、Dialog、Dropdown、Tooltip、分頁列。
- 全域底色與字色：
  - 淺色：`body bg-white text-gray-900`
  - 深色：`body bg-gray-900 text-gray-100`
- 邊框與分隔：淺色使用 `gray-200`，深色使用 `gray-700`；切換需具備 `transition-colors duration-300`。
- 主題來源：預設淺色；支援系統偏好；提供使用者手動切換，切換時全站同步。

#### 表格（DataTable）互動規範
- **項次欄位**（2025/11/17 新增）：
  - 表格最左側固定顯示「項次」欄位，寬度 64px (`w-16`)
  - 顯示 1-based 的全域索引（考慮分頁偏移）
  - hover 時左側顯示藍色邊框作為視覺回饋
- **Hover**：列需以主色淡化背景與 `ring-2` 呈現，深/淺色各自對應色階；整列變色（非單格）。
- **Selected**：使用較高對比底色（淺色 `primary-100`、深色 `primary-900/50`），可與 hover 共存。
- **分頁按鈕**（2025/11/17 更新）：
  - 使用圖示按鈕（`<<`, `<`, `>`, `>>`）取代文字按鈕
  - 圓形、具 hover/active/disabled 狀態；當前頁以主色底＋白字顯示
  - 提供「跳至第幾頁」輸入框，支援直接輸入頁碼跳轉
  - 顯示「第 X / Y 頁」Badge 標示當前頁數
- **分頁資訊模式**（2025/11/17 更新）：
  - `full`：完整顯示 `X - Y 筆，共 Z 筆`
  - `compact`：精簡顯示 `X–Y/Z`（並以 tooltip 顯示完整資訊）
  - `auto`：使用 `ResizeObserver` 動態監測容器寬度，自動在 full/compact 間切換
  - 應用建議：寬度較小的列表（如三欄式佈局的 B1 欄）優先使用 `compact` 或 `auto` 模式

#### 無障礙
- 兩種主題下文字對比需符合 WCAG AA（文字與背景 >= 4.5:1）。




#### 第三部分：安全性與技術規範
1. 系統安全
   - 身份驗證：
     - 二階段驗證 (2FA): 登入時可選用簡訊或 Email 驗證碼。
     - 自動登出： 30 分鐘無任何操作則自動登出。登出前 1 分鐘應彈窗提示，詢問是否繼續。未儲存的資料將會遺失。
   - 密碼原則：
     - 長度： 12 碼以上。
     - 複雜度： 必須包含大寫英文、小寫英文、數字、特殊符號。
     - 效期： 每 90 天強制更換密碼。
   - 權限控管 (RBAC):
     - 系統需能定義不同角色 (Role)。
     - 每個角色需能被指派可存取的選單與可操作的功能按鈕 (CRUD)。
     - 所有 API 端點皆需進行權限驗證。
2. 開發與維護
   - 程式碼結構：
     - 前端專案應依據功能模組 (Feature) 劃分資料夾結構，與 A 區主選單對應。
   - API 規範：
     - 後端應提供 RESTful API 或 GraphQL API。
     - 應使用 OpenAPI (Swagger) 撰寫並維護 API 文件。
   - 系統日誌：
     - 所有重要的使用者操作（登入、登出、新增、修改、刪除、審核等）都應被記錄到後端日誌中，包含操作者、時間、IP、操作內容。
   - 前端狀態管理：
     - 建議導入狀態管理工具 (Redux/Pinia) 進行全域狀態管理。
3. 驗證規則
    - 員工編號：必填，格式驗證（英數字組合，長度4-10字元）
    - 中文姓名：必填，不可包含特殊字元
    - 英文姓名：必填，僅允許英文字母和空格
    - 聯絡電話：格式驗證 (09-########)
    - EMAIL：必填，標準 email 格式驗證
    - 部門代碼：必選，來源於部門主檔


#### 第四部份：左側邊欄設計準則標準化方案
##### 第一階段：建立設計標準文件
1. 創建設計準則文件
  - 在專案根目錄建立 DESIGN_GUIDELINES.md
  - 記錄左側邊欄的標準配置和最佳實踐
2. 統一組件使用標準
  - 所有需要左右分割布局的頁面統一使用 ResizableLayout
  - 廢棄 MainLayout 中的 leftPanel 用法，改用 ResizableLayout
##### 第二階段：優化核心組件
1. 優化 ResizableLayout 組件
    - 調整預設參數：defaultLeftSize = 22%，minLeftSize = 18%，maxLeftSize = 35%
    - 增加專案標準配置的註釋說明
2. 優化 DataTable 組件
    - 固定表格標頭：確保 sticky 效果穩定
    - 統一搜尋框寬度：w-40 (160px)
    - 減小行高度：標頭 h-10 px-3，內容 py-2 px-3
    - 強化邊框顯示：所有單元格和表格邊框
3. 建立標準化配置
    - 創建 DataTableConfig 常數檔案
    - 統一顏色主題、間距、字體大小等設定
##### 第三階段：更新現有頁面
1. 修改客戶資料維護頁面
    - 將 MainLayout leftPanel 模式改為 ResizableLayout 模式
    - 應用新的 DataTable 優化設定
2. 統一所有左側邊欄頁面
    - 確保所有頁面使用相同的視覺風格
    - 應用統一的交互體驗
##### 第四階段：建立開發模板
1. 創建頁面開發模板
    - 提供標準的左右分割頁面模板
    - 包含 DataTable + DetailPanel 的標準組合
2. 建立組件使用指南
    - 文件化最佳實踐
    - 提供程式碼範例和使用說明
3. 設計準則重點摘要
    - 布局標準：統一使用 ResizableLayout，左側 22% 寬度
    - 表格標準：固定標頭、緊湊行高、完整邊框、小搜尋框
    - 視覺標準：統一顏色主題、間距、字體和交互效果
    - 開發標準：提供模板和指南，確保新頁面遵循相同標準




--- 
### 網站登入 頁面
1. 要輸入帳號 及 密碼，經確認後，登入成功後，才可以進入海灣文件倉儲管理系統的首頁頁面。
2. 輸入密碼時應該遮蔽，用*號來代替顯示，另提供一個按鈕，可以開啟來顯示輸入的密碼是明碼。
3. 帳號或密碼錯誤時，統一提示：「您輸入的帳號或密碼不正確，請重新輸入。錯誤次數X次。」
4. 當錯誤超過 6次後，將該帳號鎖住，並跳出警告提示「您已連續輸入錯誤達6次，帳號已被鎖定。請與管理人員聯繫」的警告提示。
5. 帳號/密碼 驗證成功後，進入文件倉儲管理系統的首頁 Dashboard。
   

### 登入後首頁 即時 Dashboard 畫面
- 上半部顯示：
  •	今日任務總覽（未完成單據、待出貨數、待稽核數）
  •	倉庫即時庫存概況（總箱數、使用率）
  •	最新通知（公告、異常提醒）
- 下半部顯示：
  - 依登入著所屬倉庫顯示自己倉庫的資訊，管理者則預設顯示全部。
  - 各倉庫箱子可存放數量 / 已存放數量 / 借出數量
  - 各倉庫今日工作狀態
  - 今日車輛派送路線及收送貨即時狀況
  - 各倉庫依客戶統計逾時未銷毀數量 (Top 10 list)
  - 依客戶統計存倉數量 (箱/件 Top 10 list)
  - 指定(客戶-部門-組別-成本中心)＋(日期範圍)＋(工作項目-工作原因) → 長條圖趨勢







