# å…±ç”¨å…ƒä»¶è¨­è¨ˆè¦ç¯„ (Shared Components Specification)

**æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0  
**ç‹€æ…‹**: è‰ç¨¿ (Draft)  
**å»ºç«‹æ—¥æœŸ**: 2025-11-28  
**ä¾æ“šæ†²ç« **: `1.å°ˆæ¡ˆæ†²ç«  Project Constitution.md` (v2.2.0)  
**ä¾æ“šè¨­è¨ˆè¦ç¯„**: `2.æ–‡ä»¶å€‰å„²ç®¡ç†ç³»çµ± Warehouse Management System è¨­è¨ˆè¦ç¯„v2.0.md`

---

## 1. ç›®çš„èˆ‡åŸå‰‡ (Purpose & Principles)

### 1.1 è¨­è¨ˆç›®çš„

æœ¬æ–‡ä»¶å®šç¾©ã€Œæ–‡ä»¶å€‰å„²ç®¡ç†ç³»çµ± 2.0ã€çš„**é€šç”¨ UI çµ„ä»¶åº«**ï¼Œç¢ºä¿ï¼š
- **ä¸€è‡´æ€§ (Consistency)**: æ‰€æœ‰åŠŸèƒ½æ¨¡çµ„ä½¿ç”¨çµ±ä¸€çš„è¦–è¦ºèªè¨€èˆ‡äº’å‹•æ¨¡å¼
- **å¯é‡ç”¨æ€§ (Reusability)**: é¿å…é‡è¤‡é–‹ç™¼ï¼Œæé«˜é–‹ç™¼æ•ˆç‡
- **å¯ç¶­è­·æ€§ (Maintainability)**: å…ƒä»¶é‚è¼¯é›†ä¸­ç®¡ç†ï¼Œé™ä½æŠ€è¡“å‚µ
- **ç¾ä»£åŒ– (Modernization)**: æ¡ç”¨ç¾ä»£ Web UX è¨­è¨ˆæ¨¡å¼ï¼Œæå‡ä½¿ç”¨è€…é«”é©—

### 1.2 éµå¾ªæ†²ç« åŸå‰‡

| æ†²ç« åŸå‰‡ | å¦‚ä½•é«”ç¾ |
|---------|---------|
| **P1: ç°¡æ½”å„ªå…ˆ** | å…ƒä»¶ API è¨­è¨ˆç°¡å–®ç›´è§€ï¼Œé¿å…éåº¦æŠ½è±¡ |
| **P2: è¨­è¨ˆå³å®‰å…¨** | å…ƒä»¶å…§å»ºè¼¸å…¥é©—è­‰èˆ‡ XSS é˜²è­· |
| **P3: æ¸…æ™°èˆ‡å¯æ¸¬è©¦** | å…ƒä»¶å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ â‰¥ 80% |
| **P8: ä¸€è‡´çš„ä½¿ç”¨è€…é«”é©—** | æ‰€æœ‰å…ƒä»¶éµå¾ªçµ±ä¸€çš„è¨­è¨ˆç³»çµ± |

---

## 2. å…ƒä»¶åˆ†é¡æ¶æ§‹ (Component Taxonomy)

```
å…±ç”¨å…ƒä»¶åº« (Shared Components)
â”‚
â”œâ”€ åŸºç¤å…ƒä»¶ (Foundation)
â”‚  â”œâ”€ Button (æŒ‰éˆ•)
â”‚  â”œâ”€ Input (è¼¸å…¥æ¡†)
â”‚  â”œâ”€ Select (ä¸‹æ‹‰é¸å–®)
â”‚  â”œâ”€ Checkbox / Radio (å‹¾é¸æ¡†/å–®é¸éˆ•)
â”‚  â””â”€ DateTimePicker (æ—¥æœŸæ™‚é–“é¸æ“‡å™¨)
â”‚
â”œâ”€ ä½ˆå±€å…ƒä»¶ (Layout)
â”‚  â”œâ”€ Tabs (åˆ†é æ¨™ç±¤)
â”‚  â”œâ”€ Modal (å°è©±æ¡†)
â”‚  â”œâ”€ Drawer (å´é‚ŠæŠ½å±œ)
â”‚  â”œâ”€ Breadcrumb (éºµåŒ…å±‘å°è¦½)
â”‚  â””â”€ Panel (é¢æ¿å®¹å™¨)
â”‚
â”œâ”€ è³‡æ–™å±•ç¤ºå…ƒä»¶ (Data Display)
â”‚  â”œâ”€ DataTable (è³‡æ–™è¡¨æ ¼)
â”‚  â”œâ”€ EditableCell (å¯ç·¨è¼¯å„²å­˜æ ¼)
â”‚  â”œâ”€ Pagination (åˆ†é å™¨)
â”‚  â””â”€ StatCard (çµ±è¨ˆå¡ç‰‡)
â”‚
â”œâ”€ è¡¨å–®å…ƒä»¶ (Form)
â”‚  â”œâ”€ FormField (å‹•æ…‹è¡¨å–®æ¬„ä½)
â”‚  â”œâ”€ FieldMapper (æ¬„ä½æ˜ å°„å™¨)
â”‚  â””â”€ FormValidator (è¡¨å–®é©—è­‰å™¨)
â”‚
â””â”€ æ¥­å‹™é‚è¼¯å…ƒä»¶ (Business Logic)
   â”œâ”€ BatchSaveToolbar (æ‰¹æ¬¡å„²å­˜å·¥å…·åˆ—)
   â”œâ”€ CascadingSelect (è¯å‹•ä¸‹æ‹‰é¸å–®)
   â””â”€ MasterDetailLayout (ä¸»å¾å¼ä½ˆå±€)
```

---

## 3. æ ¸å¿ƒä½ˆå±€å…ƒä»¶ (Core Layout Components)

### 3.1 Tabs (åˆ†é æ¨™ç±¤) ğŸ“‘

**ç”¨é€”**: å–ä»£èˆŠç³»çµ±çš„ã€Œå‚ç›´åˆ†å‰²ã€è¨­è¨ˆï¼Œå°‡è¤‡é›œåŠŸèƒ½åˆ†çµ„è‡³ä¸åŒåˆ†é ã€‚

**ä½¿ç”¨å ´æ™¯**:
- âœ… ä»£ç¢¼ç¶­è­·ï¼šå¤§åˆ†é¡ / ä¸­åˆ†é¡ / ç´°åˆ†é¡
- âœ… å®¢æˆ¶è³‡æ–™ï¼šåŸºæœ¬è³‡æ–™ / è¯çµ¡äºº / åˆç´„è³‡è¨Š
- âœ… è¨­å®šé é¢ï¼šä¸€èˆ¬è¨­å®š / é€²éšè¨­å®š / é€šçŸ¥è¨­å®š

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface TabsProps {
  defaultValue: string;          // é è¨­é¡¯ç¤ºçš„ Tab ID
  items: TabItem[];              // Tab æ¸…å–®
  onChange?: (value: string) => void; // Tab åˆ‡æ›äº‹ä»¶
  variant?: 'default' | 'pills'; // æ¨£å¼è®Šé«”
}

interface TabItem {
  value: string;      // Tab ID
  label: string;      // é¡¯ç¤ºæ–‡å­—
  icon?: ReactNode;   // å¯é¸åœ–ç¤º
  disabled?: boolean; // æ˜¯å¦ç¦ç”¨
  badge?: number;     // å¾½ç« æ•¸å­—ï¼ˆå¦‚ï¼šå¾…è™•ç†æ•¸é‡ï¼‰
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å¤§åˆ†é¡ç®¡ç†] [ä¸­åˆ†é¡ç®¡ç†] [ç´°åˆ†é¡ç®¡ç†]              â”‚ â† Tabs
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                   â”‚
â”‚  (ç•¶å‰ Tab çš„å…§å®¹)                                 â”‚
â”‚                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éŸ¿æ‡‰å¼è¡Œç‚º**:
- æ¡Œé¢: æ°´å¹³æ’åˆ—
- å¹³æ¿/æ‰‹æ©Ÿ: æ”¹ç‚ºä¸‹æ‹‰é¸å–®æˆ–å‚ç›´å †ç–Š

---

### 3.2 Modal (å°è©±æ¡†) ğŸªŸ

**ç”¨é€”**: å–ä»£èˆŠç³»çµ±çš„ã€Œå…§åµŒè¡¨å–®ã€ï¼Œæä¾›èšç„¦çš„æ–°å¢/ç·¨è¼¯é«”é©—ã€‚

**ä½¿ç”¨å ´æ™¯**:
- âœ… æ–°å¢å¤§åˆ†é¡
- âœ… ç·¨è¼¯ä¸­åˆ†é¡
- âœ… ç¢ºèªåˆªé™¤
- âœ… éŒ¯èª¤æç¤º

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface ModalProps {
  open: boolean;                     // æ˜¯å¦é–‹å•Ÿ
  onOpenChange: (open: boolean) => void; // é–‹é—œç‹€æ…‹è®Šæ›´
  title: string;                     // å°è©±æ¡†æ¨™é¡Œ
  description?: string;              // å‰¯æ¨™é¡Œ/èªªæ˜
  children: ReactNode;               // å…§å®¹å€åŸŸ
  footer?: ReactNode;                // åº•éƒ¨æŒ‰éˆ•å€ï¼ˆå¯è‡ªè¨‚ï¼‰
  size?: 'sm' | 'md' | 'lg' | 'xl';  // å°ºå¯¸
  closeOnOverlayClick?: boolean;     // é»æ“Šé®ç½©æ˜¯å¦é—œé–‰
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ æ–°å¢å¤§åˆ†é¡             [X]  â”‚ â† Title + Close
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                            â”‚
        â”‚  å¤§åˆ†é¡ç·¨ç¢¼: [______]       â”‚
        â”‚  å¤§åˆ†é¡åç¨±: [______]       â”‚ â† Content
        â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚        [å–æ¶ˆ]  [å„²å­˜]       â”‚ â† Footer
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº’å‹•è¦ç¯„**:
- æŒ‰ä¸‹ `ESC` éµæ‡‰é—œé–‰ Modal
- é–‹å•Ÿæ™‚æ‡‰é–å®šèƒŒæ™¯æ»¾å‹• (Lock Scroll)
- æ‡‰æä¾›å¹³æ»‘çš„æ·¡å…¥/æ·¡å‡ºå‹•ç•«

---

### 3.3 Drawer (å´é‚ŠæŠ½å±œ) ğŸ“‚

**ç”¨é€”**: é©ç”¨æ–¼éœ€è¦ä¿æŒä¸Šä¸‹æ–‡çš„è©³ç´°è³‡è¨Šå±•ç¤ºã€‚

**ä½¿ç”¨å ´æ™¯**:
- âœ… æŸ¥çœ‹è³‡æ–™è©³æƒ…
- âœ… ç¯©é¸å™¨é¢æ¿
- âœ… é€šçŸ¥ä¸­å¿ƒ

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface DrawerProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  title: string;
  children: ReactNode;
  position?: 'left' | 'right' | 'top' | 'bottom'; // æ»‘å‡ºæ–¹å‘
  size?: number | string;  // å¯¬åº¦æˆ–é«˜åº¦ (ä¾‹å¦‚: 400 æˆ– '30%')
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        â”‚ è³‡æ–™è©³æƒ…    [X]  â”‚ â† Drawer (Right)
â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¸»ç•«é¢  â”‚ ç·¨ç¢¼: 001        â”‚
â”‚        â”‚ åç¨±: ç‰©æ–™é¡      â”‚
â”‚        â”‚ å»ºæª”æ™‚é–“: ...     â”‚
â”‚        â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.4 Breadcrumb (éºµåŒ…å±‘å°è¦½) ğŸ

**ç”¨é€”**: é¡¯ç¤ºä½¿ç”¨è€…ç•¶å‰ä½ç½®èˆ‡å°è¦½è·¯å¾‘ã€‚

**ä½¿ç”¨å ´æ™¯**:
- âœ… åŠŸèƒ½æ¨¡çµ„å°è¦½: `é¦–é  > åŸºæœ¬ä½œæ¥­ > ä»£ç¢¼ç¶­è­·`
- âœ… è³‡æ–™éšå±¤å°è¦½: `å¤§åˆ†é¡ã€001 - ç‰©æ–™é¡ã€‘> ä¸­åˆ†é¡ã€001 - åŸç‰©æ–™ã€‘`

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface BreadcrumbProps {
  items: BreadcrumbItem[];
  separator?: ReactNode;  // åˆ†éš”ç¬¦è™Ÿ (é è¨­: ">")
}

interface BreadcrumbItem {
  label: string;         // é¡¯ç¤ºæ–‡å­—
  href?: string;         // é€£çµ (è‹¥å¯é»æ“Š)
  onClick?: () => void;  // é»æ“Šäº‹ä»¶
  current?: boolean;     // æ˜¯å¦ç‚ºç•¶å‰é 
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
é¦–é  > åŸºæœ¬ä½œæ¥­ > ä»£ç¢¼ç¶­è­·
^     ^          ^
å¯é»   å¯é»        ç•¶å‰é  (ä¸å¯é»)
```

---

## 4. è³‡æ–™å±•ç¤ºå…ƒä»¶ (Data Display Components)

### 4.1 DataTable (è³‡æ–™è¡¨æ ¼) ğŸ“Š

**ç”¨é€”**: å–ä»£èˆŠç³»çµ±çš„éœæ…‹è¡¨æ ¼ï¼Œæä¾›ç¾ä»£åŒ–çš„è³‡æ–™å±•ç¤ºèˆ‡äº’å‹•ã€‚

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… éš”è¡Œè®Šè‰² (Striped Rows)
- âœ… é¸å–é«˜äº® (Row Selection)
- âœ… è¡Œå…§ç·¨è¼¯ (Inline Editing)
- âœ… æ’åº (Sorting)
- âœ… éæ¿¾ (Filtering)
- âœ… åˆ†é  (Pagination)
- âœ… è™›æ“¬æ»¾å‹• (Virtual Scrollingï¼Œå¤§æ•¸æ“šå ´æ™¯)

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface DataTableProps<T> {
  columns: ColumnDef<T>[];       // æ¬„ä½å®šç¾©
  data: T[];                     // è³‡æ–™é™£åˆ—
  loading?: boolean;             // è¼‰å…¥ç‹€æ…‹
  emptyMessage?: string;         // ç„¡è³‡æ–™æç¤º
  striped?: boolean;             // éš”è¡Œè®Šè‰² (é è¨­: true)
  selectable?: boolean;          // æ˜¯å¦å¯é¸å–
  onRowSelect?: (rows: T[]) => void; // é¸å–äº‹ä»¶
  editable?: boolean;            // æ˜¯å¦å¯ç·¨è¼¯
  onCellEdit?: (row: T, field: string, value: any) => void;
}

interface ColumnDef<T> {
  field: string;                 // æ¬„ä½åç¨± (å°æ‡‰ data çš„ key)
  header: string;                // è¡¨é ­æ–‡å­—
  width?: number | string;       // æ¬„å¯¬
  align?: 'left' | 'center' | 'right'; // å°é½Šæ–¹å¼
  sortable?: boolean;            // æ˜¯å¦å¯æ’åº
  editable?: boolean;            // æ˜¯å¦å¯ç·¨è¼¯
  format?: (value: any, row: T) => ReactNode; // æ ¼å¼åŒ–å‡½æ•¸
  editor?: ReactNode;            // è‡ªè¨‚ç·¨è¼¯å™¨
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [âœ“] â”‚ ç·¨ç¢¼     â”‚ åç¨±      â”‚ æ“ä½œ   â”‚ â† Header
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ ] â”‚ 001      â”‚ ç‰©æ–™é¡    â”‚ [ç·¨è¼¯] â”‚ â† Row (Striped: Light)
â”‚ [âœ“] â”‚ 002      â”‚ å®¢æˆ¶é¡    â”‚ [ç·¨è¼¯] â”‚ â† Selected Row (Highlighted)
â”‚ [ ] â”‚ 003      â”‚ å€‰åº«é¡    â”‚ [ç·¨è¼¯] â”‚ â† Row (Striped: Dark)
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éŸ¿æ‡‰å¼è¡Œç‚º**:
- æ¡Œé¢: å®Œæ•´è¡¨æ ¼
- å¹³æ¿: éš±è—æ¬¡è¦æ¬„ä½
- æ‰‹æ©Ÿ: æ”¹ç‚ºå¡ç‰‡å¼ä½ˆå±€

---

### 4.2 EditableCell (å¯ç·¨è¼¯å„²å­˜æ ¼) âœï¸

**ç”¨é€”**: æ”¯æ´è¡¨æ ¼å…§çš„è¡Œå…§ç·¨è¼¯åŠŸèƒ½ã€‚

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface EditableCellProps {
  value: any;                    // ç•¶å‰å€¼
  onChange: (value: any) => void; // å€¼è®Šæ›´äº‹ä»¶
  type?: 'text' | 'number' | 'select' | 'date'; // ç·¨è¼¯å™¨é¡å‹
  options?: SelectOption[];      // Select é¡å‹çš„é¸é …
  disabled?: boolean;            // æ˜¯å¦ç¦ç”¨
  validator?: (value: any) => string | null; // é©—è­‰å‡½æ•¸
}
```

**äº’å‹•æµç¨‹**:
1. é›™æ“Šå„²å­˜æ ¼ â†’ é€²å…¥ç·¨è¼¯æ¨¡å¼
2. ä¿®æ”¹å€¼ â†’ é¡¯ç¤ºå„²å­˜æŒ‡ç¤º (å¦‚è®Šè‰²)
3. æŒ‰ `Enter` æˆ–å¤±ç„¦ â†’ æäº¤è®Šæ›´
4. æŒ‰ `ESC` â†’ å–æ¶ˆç·¨è¼¯

---

## 5. è¡¨å–®å…ƒä»¶ (Form Components)

### 5.1 FormField (å‹•æ…‹è¡¨å–®æ¬„ä½) ğŸ“

**ç”¨é€”**: æ ¹æ“šæ¬„ä½ Metadata è‡ªå‹•ç”¢ç”Ÿå°æ‡‰çš„è¡¨å–®å…ƒä»¶ã€‚

**è¨­è¨ˆåŸå‰‡** (ç¬¦åˆ 3.2 æ¬„ä½æ˜ å°„è¦ç¯„):
```typescript
interface FormFieldProps {
  metadata: FieldMetadata;       // æ¬„ä½å®šç¾© (ä¾†è‡ª API)
  value: any;                    // ç•¶å‰å€¼
  onChange: (value: any) => void;
  mode: 'create' | 'edit' | 'view'; // æ¨¡å¼ (å½±éŸ¿ editable ç‹€æ…‹)
}

interface FieldMetadata {
  dbColumn: string;              // è³‡æ–™åº«æ¬„ä½
  frontendName: string;          // å‰ç«¯æ¬„ä½åç¨± (Lovable)
  displayName: string;           // ä¸­æ–‡é¡¯ç¤ºåç¨±
  required: boolean;             // å¿…å¡«
  unique: boolean;               // å”¯ä¸€
  displayFormat: string;         // é¡¯ç¤ºæ ¼å¼
  defaultValue: string;          // æ–°å¢é è¨­å€¼
  editableInCreate: boolean;     // æ–°å¢æ™‚å¯ç·¨è¼¯
  editableInUpdate: boolean;     // ä¿®æ”¹æ™‚å¯ç·¨è¼¯
  validationRule: string;        // é©—è­‰è¦å‰‡
  errorMessage: string;          // éŒ¯èª¤è¨Šæ¯
  componentType: string;         // å…ƒä»¶é¡å‹ (å¦‚: <input type="text">)
}
```

**è‡ªå‹•å…ƒä»¶é¸æ“‡é‚è¼¯**:
```javascript
const renderField = (metadata) => {
  if (metadata.componentType.includes('datetime')) {
    return <DateTimePicker />;
  } else if (metadata.componentType.includes('select')) {
    return <Select />;
  } else if (metadata.componentType.includes('number')) {
    return <NumberInput />;
  } else {
    return <Input type="text" />;
  }
};
```

---

### 5.2 CascadingSelect (è¯å‹•ä¸‹æ‹‰é¸å–®) ğŸ”—

**ç”¨é€”**: è™•ç†çˆ¶å­é—œè¯çš„ä¸‹æ‹‰é¸å–®ï¼ˆå¦‚ï¼šå¤§åˆ†é¡ â†’ ä¸­åˆ†é¡ â†’ ç´°åˆ†é¡ï¼‰ã€‚

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface CascadingSelectProps {
  levels: CascadeLevel[];        // å±¤ç´šå®šç¾©
  values: Record<string, any>;   // å„å±¤ç´šç•¶å‰å€¼
  onChange: (level: number, value: any) => void;
}

interface CascadeLevel {
  name: string;                  // å±¤ç´šåç¨±
  placeholder: string;           // æç¤ºæ–‡å­—
  fetchOptions: (parentValue?: any) => Promise<SelectOption[]>; // å–å¾—é¸é …
}
```

**äº’å‹•è¡Œç‚º**:
```
[å¤§åˆ†é¡: 001 - ç‰©æ–™é¡ â–¼]
         â†“ (é¸æ“‡å¾Œå•Ÿç”¨)
[ä¸­åˆ†é¡: 001 - åŸç‰©æ–™ â–¼]
         â†“ (é¸æ“‡å¾Œå•Ÿç”¨)
[ç´°åˆ†é¡: 001 - Aç´šåŸæ–™ â–¼]
```

---

## 6. æ¥­å‹™é‚è¼¯å…ƒä»¶ (Business Logic Components)

### 6.1 BatchSaveToolbar (æ‰¹æ¬¡å„²å­˜å·¥å…·åˆ—) ğŸ’¾

**ç”¨é€”**: çµ±ä¸€è™•ç†ã€Œæ‰¹æ¬¡å„²å­˜ã€æ“ä½œæ¨¡å¼ï¼ˆç¬¦åˆ **P8.3 æ˜ç¢ºçš„äº¤æ˜“å„²å­˜**ï¼‰ã€‚

**æ ¸å¿ƒåŠŸèƒ½**:
- è¿½è¹¤å‰ç«¯è®Šæ›´ç‹€æ…‹ (Dirty Tracking)
- æä¾›ã€Œå„²å­˜ã€èˆ‡ã€Œå–æ¶ˆã€æŒ‰éˆ•
- æœªå„²å­˜è­¦å‘Šæç¤º

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface BatchSaveToolbarProps {
  hasChanges: boolean;           // æ˜¯å¦æœ‰æœªå„²å­˜è®Šæ›´
  onSave: () => Promise<void>;   // å„²å­˜äº‹ä»¶
  onCancel: () => void;          // å–æ¶ˆäº‹ä»¶
  saveButtonText?: string;       // å„²å­˜æŒ‰éˆ•æ–‡å­— (é è¨­: "å„²å­˜")
  cancelButtonText?: string;     // å–æ¶ˆæŒ‰éˆ•æ–‡å­— (é è¨­: "å–æ¶ˆ")
  additionalActions?: ReactNode; // å…¶ä»–æ“ä½œæŒ‰éˆ•
}
```

**è¦–è¦ºç¯„ä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¦–é  > åŸºæœ¬ä½œæ¥­ > ä»£ç¢¼ç¶­è­·    [æ–°å¢] [åˆªé™¤] â”‚
â”‚                               [å„²å­˜] [å–æ¶ˆ] â”‚ â† æœ‰è®Šæ›´æ™‚é«˜äº®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‹€æ…‹æŒ‡ç¤º**:
- ç„¡è®Šæ›´: å„²å­˜/å–æ¶ˆæŒ‰éˆ•å‘ˆç¾ç°éš (Disabled)
- æœ‰è®Šæ›´: å„²å­˜æŒ‰éˆ•ç‚º Primary é¡è‰²ï¼Œå–æ¶ˆæŒ‰éˆ•æ­£å¸¸é¡¯ç¤º

---

### 6.2 MasterDetailLayout (ä¸»å¾å¼ä½ˆå±€) ğŸ“

**ç”¨é€”**: æ¨™æº–åŒ–ã€Œä¸»å¾å¼ã€èˆ‡ã€ŒMaster-Detail-Detailã€ä½ˆå±€ã€‚

**è¨­è¨ˆè¦ç¯„**:
```typescript
interface MasterDetailLayoutProps {
  masterPanel: ReactNode;        // ä¸»åˆ—è¡¨ (å·¦å´æˆ–ä¸Šæ–¹)
  detailPanel: ReactNode;        // è©³ç´°è³‡æ–™ (å³å´æˆ–ä¸‹æ–¹)
  subDetailPanel?: ReactNode;    // ç¬¬ä¸‰å±¤ (åƒ…æ–¼ä¸‰å±¤æ¶æ§‹)
  orientation?: 'horizontal' | 'vertical'; // æ’åˆ—æ–¹å‘
  masterWidth?: number | string; // ä¸»åˆ—è¡¨å¯¬åº¦ (%)
  resizable?: boolean;           // æ˜¯å¦å¯èª¿æ•´å¤§å°
}
```

**ä½ˆå±€ç¯„ä¾‹** (ä¸‰æ¬„å¼):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚ ä¸­åˆ†é¡åˆ—è¡¨            â”‚
â”‚ å¤§åˆ†é¡    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆ—è¡¨      â”‚ ç´°åˆ†é¡åˆ—è¡¨            â”‚
â”‚          â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  25%        75% (ä¸Šä¸‹å„ 50%)
```

---

## 7. å…ƒä»¶é–‹ç™¼å„ªå…ˆç´š (Development Priority)

### Phase 1: åŸºç¤å»ºè¨­ (Foundation)
```
âœ… P1.1 Button
âœ… P1.2 Input
âœ… P1.3 Select
â–¡ P1.4 DateTimePicker
â–¡ P1.5 Checkbox / Radio
```

### Phase 2: ä½ˆå±€èˆ‡å°è¦½ (Layout & Navigation)
```
â–¡ P2.1 Tabs
â–¡ P2.2 Modal
â–¡ P2.3 Drawer
â–¡ P2.4 Breadcrumb
â–¡ P2.5 Panel
```

### Phase 3: è³‡æ–™äº’å‹• (Data Interaction)
```
â–¡ P3.1 DataTable
â–¡ P3.2 EditableCell
â–¡ P3.3 Pagination
â–¡ P3.4 FormField
â–¡ P3.5 CascadingSelect
```

### Phase 4: æ¥­å‹™æ•´åˆ (Business Integration)
```
â–¡ P4.1 BatchSaveToolbar
â–¡ P4.2 MasterDetailLayout
â–¡ P4.3 FieldMapper (Metadata-Driven)
```

---

## 8. æŠ€è¡“å¯¦ä½œæŒ‡å¼• (Implementation Guidelines)

### 8.1 æŠ€è¡“æ£§é¸æ“‡

| é¡åˆ¥ | æŠ€è¡“é¸æ“‡ | ç†ç”± |
|------|---------|------|
| **UI æ¡†æ¶** | Headless UI / Radix UI | ç„¡æ¨£å¼ã€å¯è¨‚è£½ã€ç¬¦åˆå¯åŠæ€§æ¨™æº– |
| **æ¨£å¼ç³»çµ±** | Tailwind CSS v4 | çµ±ä¸€è¨­è¨ˆèªè¨€ã€éŸ¿æ‡‰å¼å‹å–„ |
| **è¡¨å–®è™•ç†** | React Hook Form + Zod | é«˜æ•ˆèƒ½ã€é¡å‹å®‰å…¨ |
| **åœ–ç¤ºåº«** | Lucide React | ç¾ä»£ã€ä¸€è‡´ |

### 8.2 é–‹ç™¼è¦ç¯„

**æª”æ¡ˆçµæ§‹**:
```
frontend/src/components/
â”œâ”€ ui/               (åŸºç¤å…ƒä»¶)
â”‚  â”œâ”€ button.tsx
â”‚  â”œâ”€ input.tsx
â”‚  â””â”€ select.tsx
â”œâ”€ layout/           (ä½ˆå±€å…ƒä»¶)
â”‚  â”œâ”€ tabs.tsx
â”‚  â”œâ”€ modal.tsx
â”‚  â””â”€ drawer.tsx
â”œâ”€ data-display/     (è³‡æ–™å±•ç¤º)
â”‚  â”œâ”€ data-table.tsx
â”‚  â””â”€ editable-cell.tsx
â””â”€ business/         (æ¥­å‹™é‚è¼¯)
   â”œâ”€ batch-save-toolbar.tsx
   â””â”€ master-detail-layout.tsx
```

**å‘½åè¦ç¯„**:
- å…ƒä»¶æª”æ¡ˆ: `kebab-case.tsx`
- å…ƒä»¶åç¨±: `PascalCase`
- Props ä»‹é¢: `ComponentNameProps`

**æ–‡ä»¶è¦æ±‚**:
- æ¯å€‹å…ƒä»¶å¿…é ˆåŒ…å« JSDoc è¨»è§£
- å¿…é ˆæä¾› Storybook ç¯„ä¾‹
- å¿…é ˆåŒ…å«å–®å…ƒæ¸¬è©¦

---

## 9. è¨­è¨ˆç³»çµ±æ•´åˆ (Design System Integration)

### 9.1 è‰²å½©ç³»çµ±

```typescript
const colors = {
  primary: 'blue',       // ä¸»è¦æ“ä½œ
  secondary: 'gray',     // æ¬¡è¦æ“ä½œ
  success: 'green',      // æˆåŠŸç‹€æ…‹
  warning: 'yellow',     // è­¦å‘Š
  danger: 'red',         // å±éšªæ“ä½œ/éŒ¯èª¤
  info: 'blue',          // è³‡è¨Šæç¤º
};
```

### 9.2 é–“è·ç³»çµ±

éµå¾ª Tailwind çš„ 4px åŸºæº–:
- `spacing-1`: 4px
- `spacing-2`: 8px
- `spacing-4`: 16px
- `spacing-6`: 24px
- `spacing-8`: 32px

### 9.3 åœ“è§’ç³»çµ±

```
rounded-none: 0
rounded-sm:   4px
rounded:      8px
rounded-md:   12px
rounded-lg:   16px
```

---

## 10. å¯åŠæ€§è¦æ±‚ (Accessibility Requirements)

æ‰€æœ‰å…ƒä»¶**å¿…é ˆ**ç¬¦åˆ **WCAG 2.1 AA** æ¨™æº–ï¼š

- âœ… **éµç›¤å°èˆª**: æ‰€æœ‰äº’å‹•å…ƒä»¶å¯ç”¨éµç›¤æ“ä½œ
- âœ… **è¢å¹•é–±è®€å™¨**: æä¾› ARIA æ¨™ç±¤
- âœ… **å°æ¯”åº¦**: æ–‡å­—å°æ¯”åº¦ â‰¥ 4.5:1
- âœ… **Focus æŒ‡ç¤º**: æ˜ç¢ºçš„ç„¦é»æ¡†
- âœ… **éŒ¯èª¤æç¤º**: æ˜ç¢ºçš„éŒ¯èª¤è¨Šæ¯èˆ‡èªªæ˜

---

## 11. æ•ˆèƒ½è¦æ±‚ (Performance Requirements)

| æŒ‡æ¨™ | ç›®æ¨™å€¼ |
|------|--------|
| **é¦–æ¬¡æ¸²æŸ“** (FCP) | < 1.5s |
| **äº’å‹•å»¶é²** (INP) | < 200ms |
| **è¡¨æ ¼æ¸²æŸ“** (1000 rows) | < 2s |
| **Bundle Size** (æ¯å€‹å…ƒä»¶) | < 50KB (gzipped) |

---

## 12. æ¸¬è©¦ç­–ç•¥ (Testing Strategy)

### 12.1 å–®å…ƒæ¸¬è©¦

ä½¿ç”¨ **Vitest + React Testing Library**:
```typescript
describe('Button', () => {
  it('should render with correct text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });

  it('should call onClick when clicked', () => {
    const handleClick = vi.fn();
    render(<Button onClick={handleClick}>Click</Button>);
    fireEvent.click(screen.getByText('Click'));
    expect(handleClick).toHaveBeenCalledOnce();
  });
});
```

### 12.2 è¦–è¦ºæ¸¬è©¦

ä½¿ç”¨ **Storybook + Chromatic**:
- æ¯å€‹å…ƒä»¶è‡³å°‘åŒ…å« 3 å€‹ Stories (Default, Disabled, Error)
- è‡ªå‹•æˆªåœ–æ¯”å°ï¼Œé˜²æ­¢è¦–è¦ºå›æ­¸

---

## 13. æ–‡ä»¶èˆ‡ç¤ºç¯„ (Documentation & Examples)

### 13.1 Storybook 

æ¯å€‹å…ƒä»¶å¿…é ˆåŒ…å«ï¼š
1. **Overview**: å…ƒä»¶ç”¨é€”èˆ‡ä½¿ç”¨å ´æ™¯
2. **Props API**: æ‰€æœ‰ Props çš„èªªæ˜
3. **Examples**: è‡³å°‘ 5 å€‹ä½¿ç”¨ç¯„ä¾‹
4. **Best Practices**: æœ€ä½³å¯¦è¸å»ºè­°

### 13.2 README.md

```markdown
# Button

## å®‰è£
```bash
import { Button } from '@/components/ui/button';
```

## ä½¿ç”¨ç¯„ä¾‹
```tsx
<Button variant="primary" onClick={handleClick}>
  å„²å­˜
</Button>
```

## Props
| Prop | Type | Default | Description |
|------|------|---------|-------------|
| variant | 'primary' \| 'secondary' | 'primary' | æŒ‰éˆ•æ¨£å¼ |
```

---

## é™„éŒ„ A: èˆ‡èˆŠç³»çµ±å°ç…§è¡¨

| èˆŠç³»çµ±è¨­è¨ˆ | æ–°ç³»çµ±å…ƒä»¶ | æ”¹å–„é» |
|-----------|-----------|--------|
| å‚ç›´åˆ†å‰²è¦–çª— | `<Tabs>` | ç°¡åŒ–è¦–è¦ºå±¤æ¬¡ã€éŸ¿æ‡‰å¼å‹å–„ |
| å…§åµŒè¡¨å–®ç·¨è¼¯ | `<Modal>` / `<Drawer>` | èšç„¦æ“ä½œã€é¿å…å¹²æ“¾ |
| å›ºå®šè¡¨æ ¼ | `<DataTable>` | å‹•æ…‹æ’åºã€éæ¿¾ã€è¡Œå…§ç·¨è¼¯ |
| ç„¡è·¯å¾‘æç¤º | `<Breadcrumb>` | æ˜ç¢ºä½ç½®ã€æ˜“æ–¼å°èˆª |
| æ‰‹å‹•æ¬„ä½å°æ‡‰ | `<FormField>` + Metadata | è³‡æ–™é©…å‹•ã€è‡ªå‹•é©—è­‰ |

---

**æ–‡ä»¶ç‰ˆæœ¬**: v1.0.0 (è‰ç¨¿)  
**ä¸‹ä¸€æ­¥**: å»ºç«‹å…ƒä»¶é–‹ç™¼ Roadmap èˆ‡ Prototype
